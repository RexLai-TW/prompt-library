<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>âœˆï¸ Prompt Copilot v7.3.1 | Rex & Pi</title>
    <style>
        :root {
            --primary: #3b82f6;
            --bg: #f8fafc;
            --card: #ffffff;
            --text: #1e293b;
            --muted: #64748b;
            --header-bg: linear-gradient(135deg, #0f172a 0%, #334155 100%);
        }
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body { margin: 0; font-family: 'Segoe UI', system-ui, -apple-system, sans-serif; background-color: var(--bg); color: var(--text); line-height: 1.5; }
        
        /* Header */
        .header { background: var(--header-bg); color: white; padding: 16px 24px; display: flex; justify-content: space-between; align-items: center; box-shadow: 0 4px 12px rgba(0,0,0,0.1); }
        .header-title { display: flex; flex-direction: column; }
        .header-title h1 { margin: 0; font-size: 20px; font-weight: 600; display: flex; align-items: center; gap: 8px; }
        .version-badge { font-size: 12px; background: var(--primary); padding: 2px 8px; border-radius: 4px; opacity: 0.9; }
        .header-subtitle { font-size: 11px; opacity: 0.8; margin-top: 4px; }
        
        .tutorial-btn { background-color: #FF0000; color: white; padding: 6px 14px; border-radius: 20px; text-decoration: none; font-size: 13px; font-weight: 600; display: flex; align-items: center; gap: 6px; transition: 0.2s; border: 1px solid rgba(255,255,255,0.2); }
        .tutorial-btn:hover { background-color: #cc0000; transform: translateY(-1px); }
        .status-badge { font-size: 12px; background: rgba(255,255,255,0.1); padding: 4px 12px; border-radius: 20px; backdrop-filter: blur(4px); margin-left: 12px; }

        /* Main Container */
        .main-container { max-width: 1200px; margin: 24px auto; display: flex; gap: 24px; padding: 0 20px; flex-wrap: wrap; }
        .panel { background: var(--card); border-radius: 12px; border: 1px solid #e2e8f0; padding: 24px; box-shadow: 0 1px 3px rgba(0,0,0,0.1); }
        .left-panel { flex: 1; min-width: 350px; }
        .right-panel { flex: 1.2; min-width: 350px; background-color: #f8fafc; }

        /* UI Elements */
        .lang-toggle { display: flex; gap: 10px; margin-bottom: 20px; }
        .lang-btn { flex: 1; padding: 10px; border: 1px solid #e2e8f0; border-radius: 8px; background: white; cursor: pointer; font-size: 14px; transition: 0.2s; }
        .lang-btn.active { background: var(--primary); color: white; border-color: var(--primary); font-weight: 600; }

        .guide-box { background: #f0f9ff; padding: 12px 16px; border-radius: 8px; font-size: 13px; color: #0369a1; margin-bottom: 20px; border-left: 4px solid #0ea5e9; display: flex; align-items: center; gap: 10px; }
        
        .section-label { font-size: 11px; font-weight: 800; color: #64748b; letter-spacing: 1px; margin-bottom: 12px; text-transform: uppercase; margin-top: 20px; display: block; }
        
        select, input[type="text"] { width: 100%; padding: 12px; border-radius: 8px; border: 1px solid #cbd5e1; background: white; font-size: 14px; outline: none; margin-bottom: 12px; transition: 0.2s; }
        select:focus, input:focus { border-color: var(--primary); box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1); }
        
        .description-box { color: #64748b; font-size: 13px; margin-bottom: 16px; display: flex; align-items: flex-start; gap: 6px; }

        .multi-select { width: 100%; height: 200px; border: 1px solid #cbd5e1; border-radius: 8px; overflow-y: auto; background: white; margin-bottom: 12px; }
        .item { padding: 10px 12px; border-bottom: 1px solid #f1f5f9; cursor: pointer; display: flex; align-items: center; gap: 10px; font-size: 14px; }
        .item:hover { background: #f8fafc; }
        .item.active { background: #eff6ff; color: var(--primary); font-weight: 600; }
        .item input { width: 16px; height: 16px; accent-color: var(--primary); pointer-events: none; }

        textarea { width: 100%; height: 480px; border: 1px solid #cbd5e1; border-radius: 8px; padding: 16px; font-family: 'Consolas', 'Monaco', 'Courier New', monospace; font-size: 14px; line-height: 1.6; resize: none; background: white; margin-top: 8px; }

        .copy-btn { background: var(--primary); color: white; border: none; padding: 16px; border-radius: 8px; font-size: 16px; font-weight: 700; width: 100%; cursor: pointer; transition: 0.3s; margin-top: 16px; display: flex; align-items: center; justify-content: center; gap: 8px; box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1); }
        .copy-btn:hover { background: #2563eb; transform: translateY(-1px); box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1); }
        .copy-btn:active { transform: scale(0.98); }

        hr { border: 0; border-top: 1px dashed #e2e8f0; margin: 20px 0; }
        
        #build-info { font-size: 9px; color: var(--muted); text-align: center; margin-top: 10px; }

        @media (max-width: 800px) {
            .main-container { flex-direction: column; }
            .panel { min-width: 100%; }
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="header-title">
            <h1>âœˆï¸ Prompt Copilot <span class="version-badge">v7.3.1 Hotfix</span></h1>
            <div class="header-subtitle">Developed by Neurora_AITec Studio</div>
        </div>
        <div style="display:flex; align-items:center;">
            <a href="https://youtu.be/QCm8gAg9vqg?si=Dyoeo-FCNmZ5mWfd" target="_blank" class="tutorial-btn">
                <svg viewBox="0 0 24 24" width="16" height="16" fill="currentColor"><path d="M23.498 6.186a3.016 3.016 0 0 0-2.122-2.136C19.505 3.545 12 3.545 12 3.545s-7.505 0-9.377.505A3.017 3.017 0 0 0 .502 6.186C0 8.07 0 12 0 12s0 3.93.502 5.814a3.016 3.016 0 0 0 2.122 2.136c1.871.505 9.376.505 9.376.505s7.505 0 9.377-.505a3.015 3.015 0 0 0 2.122-2.136C24 15.93 24 12 24 12s0-3.93-.502-5.814zM9.545 15.568V8.432L15.818 12l-6.273 3.568z"/></svg>
                Tutorial
            </a>
            <div id="connection-status" class="status-badge">ğŸŸ¡ é€£ç·šä¸­...</div>
        </div>
    </div>

    <div class="main-container">
        <!-- Left Panel -->
        <div class="panel left-panel">
            <div class="lang-toggle">
                <button id="lang-zh" class="lang-btn active" onclick="setLang('zh')">ğŸ‡¹ğŸ‡¼ Taiwan (ç¹é«”ä¸­æ–‡)</button>
                <button id="lang-en" class="lang-btn" onclick="setLang('en')">ğŸŒ Global (English)</button>
            </div>

            <div id="guide-text" class="guide-box"></div>

            <span class="section-label" id="lbl-config">CONFIG (è¨­å®š)</span>
            <label class="section-label" style="margin-top:0; font-size:10px;" id="lbl-lib">ğŸ“š æ¨¡çµ„åº«:</label>
            <select id="lib-select" onchange="onLibChange()"></select>
            
            <label class="section-label" style="margin-top:0; font-size:10px;" id="lbl-role">ğŸ“‚ é¡åˆ¥:</label>
            <select id="role-select" onchange="onRoleChange()"></select>
            
            <label class="section-label" style="margin-top:0; font-size:10px;" id="lbl-task">âš¡ ä»»å‹™:</label>
            <select id="task-select" onchange="onTaskChange()"></select>

            <hr>
            <span class="section-label" id="lbl-vars">VARIABLES (åƒæ•¸)</span>
            <div id="vars-container"></div>
        </div>

        <!-- Right Panel -->
        <div class="panel right-panel">
            <span class="section-label" style="margin-top:0;" id="lbl-result">RESULT (çµæœ)</span>
            <label class="section-label" style="margin-top:0; font-size:10px;" id="lbl-mode">ğŸ›ï¸ è¼¸å‡ºæ¨¡å¼:</label>
            <select id="mode-select" onchange="updateResult()"></select>
            
            <textarea id="result-text" placeholder="ç­‰å¾…è¨­å®šä¸­..."></textarea>
            
            <button id="copy-btn" class="copy-btn" onclick="handleCopy()">
                <svg viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                <span id="btn-text">è¤‡è£½ Prompt (Copy)</span>
            </button>
            <div id="build-info">BUILD: 20260205-1320 | å¦‚æœæŒ‰éˆ•ç„¡æ•ˆè«‹é•·æŒ‰æ–‡å­—æ¡†å…¨é¸</div>
        </div>
    </div>

    <script>
        const INDEX_URLS = {
            "zh": "https://gist.githubusercontent.com/weihua-studio/051d3a6a6a50ef1690166b9502212c5e/raw/53bac320780be653728e9e5dae0b1369e7e599c5/library_index.json",
            "en": "https://gist.githubusercontent.com/weihua-studio/07ca630b76a6e93f26367df8112c248f/raw/2434214848fc1dab76fdc36e0d7e143355acdc0c/library_index_GlobalWorld.json"
        };
        const FALLBACK_LIBRARIES = {"âš ï¸ Offline Backup": "https://gist.githubusercontent.com/weihua-wang/raw/prompts.json"};

        const UI_TEXT = {
            "zh": {
                "guide": "ğŸ’¡ ğŸ‘ˆ <b>å·¦å´è‡ªç”±æ¢ç´¢</b>æ¨¡çµ„èˆ‡åƒæ•¸ï¼Œè¨­å®šå®Œæˆå¾Œåˆ¥å¿˜äº†é»æ“Šå³å´ <b>[è¤‡è£½ Prompt]</b> å¸¶èµ°ä½ çš„å’’èªï¼",
                "lbl_lib": "ğŸ“š æ¨¡çµ„åº«:", "lbl_role": "ğŸ“‚ é¡åˆ¥:", "lbl_task": "âš¡ ä»»å‹™:",
                "lbl_config": "CONFIG (è¨­å®š)", "lbl_vars": "VARIABLES (åƒæ•¸)", "lbl_result": "RESULT (çµæœ)",
                "lbl_output_mode": "ğŸ›ï¸ è¼¸å‡ºæ¨¡å¼:", "btn_copy": "è¤‡è£½ Prompt (Copy)", "btn_copied": "å·²è¤‡è£½! âœ…",
                "status_online": "ğŸŸ¢ é€£ç·šæ­£å¸¸", "status_offline": "ğŸŸ¡ é›¢ç·šæ¨¡å¼",
                "mode_options": [
                    ["ğŸš€ æ™ºèƒ½é è¨­ (Auto)", ""],
                    ["ğŸ¤« éœé»˜æ¥æ”¶æ¨¡å¼ (Silent Ack)", "ã€ç³»çµ±æç¤ºã€‘ï¼šè«‹æ¥æ”¶ä»¥ä¸‹è¼¸å…¥å…§å®¹ï¼Œä½†ã€å…ˆä¸è¦åŸ·è¡Œã€‘ä»»ä½•ä»»å‹™ã€‚ä½ åªéœ€è¦ç°¡å–®å›è¦†ä¸€å¥ã€ğŸ†— æ”¶åˆ°ï¼Œæˆ‘å·²ç†è§£æ‚¨çš„æŒ‡ä»¤ï¼Œè«‹è¼¸å…¥ OK è®“æˆ‘é–‹å§‹åŸ·è¡Œã€‚ã€ï¼Œç„¶å¾Œç­‰å¾…ä½¿ç”¨è€…çš„ä¸‹ä¸€å€‹ä¿¡è™Ÿã€‚é™¤æ­¤ä¹‹å¤–ä¸è¦è¼¸å‡ºä»»ä½•å…¶ä»–å…§å®¹ã€‚\n\n----------------\n\n"],
                    ["ğŸ¨ ç¹ªåœ–å’’èªå¤§å¸« (Midjourney)", "ã€ç³»çµ±æç¤ºã€‘ï¼šè«‹æ‰®æ¼”å°ˆæ¥­çš„ AI ç¹ªåœ–è© å”±å¸« (Prompt Engineer)ã€‚è«‹æ ¹æ“šç”¨æˆ¶ä¸‹æ–¹çš„æè¿°ï¼Œæ’°å¯«çµ¦ Midjourney v6 ä½¿ç”¨çš„ã€Œè‹±æ–‡æç¤ºè©ã€ã€‚åŒ…å«ï¼šä¸»é«”ã€è—è¡“é¢¨æ ¼ã€å…‰å½±ã€é¡é ­è§’åº¦åŠé•·å¯¬æ¯” (--ar)ã€‚ä¸éœ€è¦è§£é‡‹ï¼Œç›´æ¥è¼¸å‡ºæç¤ºè©å³å¯ã€‚\n\n----------------\n\n"],
                    ["ğŸ¬ å½±ç‰‡é‹é¡å°æ¼” (Sora/Runway)", "ã€ç³»çµ±æç¤ºã€‘ï¼šè«‹æ‰®æ¼”å°ˆæ¥­çš„ AI å½±ç‰‡å°æ¼”ã€‚è«‹æ ¹æ“šç”¨æˆ¶éœ€æ±‚ï¼Œæ’°å¯«è©³ç´°çš„å½±ç‰‡ç”Ÿæˆæç¤ºè©ã€‚é‡é»æè¿°ï¼šé‹é¡æ–¹å¼ (Pan, Zoom, Dolly)ã€å…‰å½±æ°›åœã€ç‰©ç†å‹•æ…‹ä»¥åŠå ´æ™¯é€£è²«æ€§ã€‚æ ¼å¼è«‹é‡å° Runway Gen-2 æˆ– Sora å„ªåŒ–ã€‚\n\n----------------\n\n"],
                    ["ğŸµ éŸ³æ¨‚è£½ä½œäºº (Suno/Udio)", "ã€ç³»çµ±æç¤ºã€‘ï¼šä½ ç¾åœ¨æ˜¯ AI éŸ³æ¨‚è£½ä½œäººã€‚è«‹æ’°å¯«çµ¦ Suno æˆ– Udio çš„éŸ³æ¨‚ç”Ÿæˆæç¤ºè©ã€‚è«‹æ˜ç¢ºæŒ‡å®šï¼šéŸ³æ¨‚æµæ´¾ (Genre)ã€æƒ…ç·’æ°›åœ (Mood)ã€ä½¿ç”¨æ¨‚å™¨ã€é€Ÿåº¦ (BPM) ä»¥åŠæ­Œè©çµæ§‹ (Verse/Chorus)ã€‚\n\n----------------\n\n"],
                    ["ğŸ“ ç´”æ–‡å­—è¼¸å‡º (Text Only)", "ã€ç³»çµ±æç¤ºã€‘ï¼šç³»çµ±å¼·åˆ¶è¦†å¯«ï¼šè¼¸å‡ºçµæœå¿…é ˆåš´æ ¼é™åˆ¶ç‚ºã€Œç´”æ–‡å­—ã€ã€‚é™¤éç”¨æˆ¶ç‰¹åˆ¥è¦æ±‚ï¼Œå¦å‰‡ã€ç¦æ­¢ã€‘ç”Ÿæˆåœ–ç‰‡ã€ç¨‹å¼ç¢¼å€å¡Šæˆ–å‘¼å«ä»»ä½•å¤šåª’é«”å·¥å…·ã€‚è«‹ä¿æŒç‰ˆé¢ä¹¾æ·¨æ˜“è®€ã€‚\n\n----------------\n\n"],
                    ["ğŸ ç´”ä»£ç¢¼æ¨¡å¼ (Code Only)", "ã€ç³»çµ±æç¤ºã€‘ï¼šä½ ç¾åœ¨æ˜¯ä¸€å°ç„¡æƒ…çš„å¯«ç¨‹å¼æ©Ÿå™¨ã€‚é‡å°ç”¨æˆ¶çš„å•é¡Œï¼Œã€åªè¼¸å‡ºç¨‹å¼ç¢¼å€å¡Šã€‘(Python/JS/HTML ç­‰)ã€‚ä¸è¦æœ‰ä»»ä½•é–‹å ´ç™½ã€çµå°¾ã€è§£é‡‹æˆ–è¨»è§£ã€‚çµ¦æˆ‘ code å°±å¥½ã€‚\n\n----------------\n\n"],
                    ["ğŸ é™¤éŒ¯é†«ç”Ÿ (Bug Fixer)", "ã€ç³»çµ±æç¤ºã€‘ï¼šè«‹åˆ†æä»¥ä¸‹ç¨‹å¼ç¢¼çš„éŒ¯èª¤ (Bug)ã€‚å…ˆç”¨ç°¡çŸ­çš„ä¸€å¥è©±è§£é‡‹éŒ¯èª¤åŸå› ï¼Œç„¶å¾Œæä¾›ã€ä¿®æ­£å¾Œçš„å®Œæ•´ç¨‹å¼ç¢¼å€å¡Šã€‘ã€‚è«‹æ³¨é‡ç¨‹å¼çš„å®‰å…¨æ€§å’ŒåŸ·è¡Œæ•ˆç‡ã€‚\n\n----------------\n\n"],
                    ["ğŸ‘¶ è²»æ›¼å­¸ç¿’æ³• (ELI5)", "ã€ç³»çµ±æç¤ºã€‘ï¼šè«‹æŠŠä»¥ä¸‹çš„å…§å®¹è§£é‡‹çµ¦æˆ‘è½ï¼Œå‡è¨­æˆ‘æ˜¯ä¸€å€‹åªæœ‰ 5 æ­²çš„å°æœ‹å‹ã€‚ä½¿ç”¨ç°¡å–®çš„ç”Ÿæ´»è­¬å–»ï¼Œé¿å…å°ˆæ¥­è¡“èªï¼Œèªæ°£è¦ç”Ÿå‹•æœ‰è¶£ã€‚\n\n----------------\n\n"],
                    ["ğŸ§  æ·±åº¦æ€è€ƒéˆ (CoT)", "ã€ç³»çµ±æç¤ºã€‘ï¼šè«‹ä¸è¦ç›´æ¥çµ¦æˆ‘ç­”æ¡ˆã€‚è«‹ä½¿ç”¨ã€Œæ€ç¶­éˆ (Chain of Thought)ã€æ¨¡å¼ï¼Œä¸€æ­¥ä¸€æ­¥åœ°æ€è€ƒã€‚å°‡å•é¡Œæ‹†è§£ï¼Œåˆ†æåˆ©å¼Šï¼Œå±•ç¤ºä½ çš„æ¨è«–éç¨‹ï¼Œæœ€å¾Œå†çµ¦å‡ºçµè«–ã€‚\n\n----------------\n\n"],
                    ["ğŸ“¹ YouTube è…³æœ¬ (Script)", "ã€ç³»çµ±æç¤ºã€‘ï¼šè«‹æ ¹æ“šè¼¸å…¥çš„ä¸»é¡Œï¼Œæ’°å¯«ä¸€ä»½é«˜æµé‡çš„ YouTube å½±ç‰‡è…³æœ¬ã€‚çµæ§‹éœ€åŒ…å«ï¼šé»ƒé‡‘ 5 ç§’é–‹å ´ (Hook)ã€å‰è¨€ã€ä¸‰å€‹æ ¸å¿ƒé‡é»æ®µè½ã€ä»¥åŠçµå°¾è¡Œå‹•å‘¼ç±² (CTA)ã€‚èªæ°£è¦åƒ YouTuber ä¸€æ¨£å£èªä¸”æœ‰å¸å¼•åŠ›ã€‚\n\n----------------\n\n"],
                    ["ğŸ“§ Email æ½¤é£¾ (Polish)", "ã€ç³»çµ±æç¤ºã€‘ï¼šè«‹å°‡ä»¥ä¸‹è‰ç¨¿æ½¤é£¾ç‚ºä¸€å°ã€Œå°ˆæ¥­ã€ç¦®è²Œä¸”ç°¡æ½”ã€çš„å•†å‹™é›»å­éƒµä»¶ã€‚ä¿®æ­£èªæ³•éŒ¯èª¤ï¼Œä¸¦æå‡æ•´é«”çš„å°ˆæ¥­èªæ°£ã€‚\n\n----------------\n\n"],
                    ["ğŸ“‹ é‡é»æ‘˜è¦ (TL;DR)", "ã€ç³»çµ±æç¤ºã€‘ï¼šè«‹é–±è®€ä»¥ä¸‹å…§å®¹ï¼Œä¸¦ä»¥åˆ—é»æ–¹å¼ (Bullet points) æä¾›ã€Œé‡é»æ‘˜è¦ (TL;DR)ã€ã€‚åªä¿ç•™æœ€é—œéµçš„è³‡è¨Šï¼Œéæ¿¾æ‰å»¢è©±ã€‚\n\n----------------\n\n"],
                    ["ğŸ˜ˆ é­”é¬¼ä»£è¨€äºº (Critic)", "ã€ç³»çµ±æç¤ºã€‘ï¼šè«‹æ“”ä»»ã€Œé­”é¬¼ä»£è¨€äººã€çš„è§’è‰²ã€‚é‡å°ä»¥ä¸‹çš„è§€é»æˆ–è¨ˆç•«ï¼Œæ‰¾å‡ºé‚è¼¯æ¼æ´ã€æ½›åœ¨é¢¨éšªæˆ–ç¼ºé»ã€‚è«‹æ¯«ä¸ç•™æƒ…åœ°é€²è¡Œæ‰¹åˆ¤æ€§å¯©æŸ¥ï¼Œä½†è¦ä¿æŒå»ºè¨­æ€§ã€‚\n\n----------------\n\n"],
                    ["ğŸ“Š æ•¸æ“šçµæ§‹åŒ– (JSON)", "ã€ç³»çµ±æç¤ºã€‘ï¼šè«‹å°‡ä»¥ä¸‹è³‡è¨Šè½‰æ›ç‚ºæ¨™æº–çš„ JSON æ ¼å¼ã€‚ä¸è¦ä½¿ç”¨ Markdown æˆ–ä»»ä½•å°è©±æ–‡å­—ï¼Œç›´æ¥è¼¸å‡º Raw JSON æ•¸æ“šã€‚\n\n----------------\n\n"],
                    ["ğŸŒ ç¿»è­¯è’Ÿè’» (Translate)", "ã€ç³»çµ±æç¤ºã€‘ï¼šè«‹å°‡ä»¥ä¸‹å…§å®¹ç¿»è­¯æˆè‡ªç„¶ã€é€šé †çš„ã€Œå°ç£ç¹é«”ä¸­æ–‡ã€ã€‚é¿å…ä½¿ç”¨æ©Ÿå™¨ç¿»è­¯çš„ç”Ÿç¡¬èªæ°£ï¼Œè«‹ä½¿ç”¨å°ç£åœ¨åœ°çš„ç¿’æ…£ç”¨èªã€‚\n\n----------------\n\n"],
                    ["ğŸ’¡ å‰µæ„é¢¨æš´ (Brainstorming)", "ã€ç³»çµ±æç¤ºã€‘ï¼šè«‹é‡å°ç”¨æˆ¶æä¾›çš„ä¸»é¡Œï¼Œé€²è¡Œè…¦åŠ›æ¿€ç›ªã€‚åˆ—å‡º 10 å€‹ç¨ç‰¹ã€å‰µæ–°ä¸”è¦–è§’å¤šå…ƒçš„é»å­ã€‚è«‹è·³è„«æ¡†æ¶æ€è€ƒ (Think outside the box)ã€‚\n\n----------------\n\n"],
                    ["ğŸ§¼ æ´—ç¨¿å¤§å¸« (Rewrite)", "ã€ç³»çµ±æç¤ºã€‘ï¼šè«‹æ”¹å¯«ä»¥ä¸‹æ–‡ç« ã€‚ä¿ç•™åŸæœ¬çš„æ ¸å¿ƒèªæ„ï¼Œä½†å¤§å¹…æ”¹è®Šå¥å‹çµæ§‹å’Œç”¨è©ï¼Œä½¿å…¶æˆç‚ºä¸€ç¯‡ç„¡æ³•è¢«æª¢æ¸¬å‡ºé‡è¤‡çš„åŸå‰µæ–‡ç« ã€‚\n\n----------------\n\n"],
                    ["ğŸ”® ç„å­¸å¤§å¸« (Mystic)", "ã€ç³»çµ±æç¤ºã€‘ï¼šè«‹ç”¨ç„å­¸ã€å‘½ç†æˆ–å¡”ç¾…å åœå¸«çš„å£å»å›ç­”ä»¥ä¸‹å•é¡Œã€‚å¤šä½¿ç”¨èˆ‡æ˜Ÿè±¡ã€å‘½é‹ã€èƒ½é‡æµå‹•ç›¸é—œçš„éš±å–»ï¼Œè®“ç­”æ¡ˆå……æ»¿ç¥ç§˜æ„Ÿã€‚\n\n----------------\n\n"],
                    ["ğŸ›Œ æ‡¶äººåŒ…æ•™å­¸ (Step-by-Step)", "ã€ç³»çµ±æç¤ºã€‘ï¼šè«‹å°‡é€™é …ä»»å‹™æ‹†è§£ç‚ºä¸€ä»½ç°¡å–®æ˜“æ‡‚çš„ã€Œå‚»ç“œæ•™å­¸ã€ã€‚è«‹ä½¿ç”¨ç·¨è™Ÿæ­¥é©Ÿ (Step 1, Step 2...)ï¼Œä¸¦ç¢ºä¿æ¯å€‹æ­¥é©Ÿéƒ½å…·é«”å¯è¡Œã€‚\n\n----------------\n\n"]
                ]
            },
            "en": {
                "guide": "ğŸ’¡ ğŸ‘ˆ <b>Explore</b> the settings on the left, and don't forget to click <b>[Copy Prompt]</b> on the right!",
                "lbl_lib": "ğŸ“š Library:", "lbl_role": "ğŸ“‚ Category:", "lbl_task": "âš¡ Task:",
                "lbl_config": "CONFIG", "lbl_vars": "VARIABLES", "lbl_result": "RESULT",
                "lbl_output_mode": "ğŸ›ï¸ Output Mode:", "btn_copy": "Copy Prompt", "btn_copied": "Copied! âœ…",
                "status_online": "ğŸŸ¢ Online", "status_offline": "ğŸŸ¡ Offline",
                "mode_options": [
                    ["ğŸš€ Auto / Default", ""],
                    ["ğŸ¤« Silent Receiver (Ack Only)", "SYSTEM OVERRIDE: Receive the following input BUT DO NOT EXECUTE IT YET. Simply reply with 'ğŸ†— Received. Waiting for your command.' and wait for the user's next signal. Do not output anything else.\n\n----------------\n\n"],
                    ["ğŸ¨ Image Gen Master (Midjourney)", "SYSTEM OVERRIDE: Act as a professional prompt engineer for AI image generators (Midjourney v6). Write a detailed, comma-separated prompt including Subject, Art Style, Lighting, Camera Angle, and Aspect Ratio (--ar).\n\n----------------\n\n"],
                    ["ğŸ¬ Video Director (Sora/Runway)", "SYSTEM OVERRIDE: Act as a professional AI video director. Write a detailed video generation prompt focusing on Camera Movement, Lighting, Physics, and Continuity.\n\n----------------\n\n"],
                    ["ğŸµ Music Producer (Suno/Udio)", "SYSTEM OVERRIDE: Act as a music prompt specialist. Create a structured prompt for AI music generators specifying: Genre, Mood, Instruments, Tempo, and Lyrics structure.\n\n----------------\n\n"],
                    ["ğŸ“ Text Only Mode", "SYSTEM OVERRIDE: Output must be strictly text only. DO NOT generate images, code blocks, or multimedia tools unless requested.\n\n----------------\n\n"],
                    ["ğŸ Code Generator (No Yapping)", "SYSTEM OVERRIDE: You are a coding machine. Output ONLY the code block to solve the problem. Do not provide explanations or comments. Just the code.\n\n----------------\n\n"],
                    ["ğŸ Bug Fixer (Debug)", "SYSTEM OVERRIDE: Analyze the input code for bugs. Explain the error briefly, then provide the corrected code block.\n\n----------------\n\n"],
                    ["ğŸ‘¶ ELI5 (Simple Logic)", "SYSTEM OVERRIDE: Explain the concept as if I am a 12-year-old beginner. Use simple analogies and avoid jargon.\n\n----------------\n\n"],
                    ["ğŸ§  Chain of Thought (CoT)", "SYSTEM OVERRIDE: Think step-by-step. Break down the problem, analyze pros and cons, and show your reasoning process.\n\n----------------\n\n"],
                    ["ğŸ“¹ YouTube Script (Viral)", "SYSTEM OVERRIDE: Write a compelling YouTube video script. Include: Hook, Intro, Main Content, and CTA. Use an engaging tone.\n\n----------------\n\n"],
                    ["ğŸ“§ Email Polisher (Professional)", "SYSTEM OVERRIDE: Rewrite the draft into a professional, concise business email. Fix grammar and tone.\n\n----------------\n\n"],
                    ["ğŸ“‹ TL;DR Summary (Key Points)", "SYSTEM OVERRIDE: Read the content and provide a bulleted summary of the key takeaways.\n\n----------------\n\n"],
                    ["ğŸ˜ˆ Devil's Advocate (Critic)", "SYSTEM OVERRIDE: Act as a critical reviewer. Find flaws, logic gaps, or potential risks in the idea. Be harsh but constructive.\n\n----------------\n\n"],
                    ["ğŸ“Š JSON Converter (Data)", "SYSTEM OVERRIDE: Convert the information into valid JSON format. Do not add markdown or conversational text, just the data.\n\n----------------\n\n"],
                    ["ğŸŒ Translate to Chinese (TW)", "SYSTEM OVERRIDE: Translate the following text into natural, fluent Traditional Chinese.\n\n----------------\n\n"],
                    ["ğŸ’¡ Brainstorming (Ideas)", "SYSTEM OVERRIDE: Generate 10 unique and creative ideas based on the input topic.\n\n----------------\n\n"],
                    ["ğŸ§¼ Paraphraser (Rewrite)", "SYSTEM OVERRIDE: Rewrite the text to make it unique while retaining the original meaning.\n\n----------------\n\n"],
                    ["ğŸ”® Mystic Oracle (Tarot Style)", "SYSTEM OVERRIDE: Answer with a mystical tone, using metaphors related to stars and fate.\n\n----------------\n\n"],
                    ["ğŸ›Œ Step-by-Step Guide (How-to)", "SYSTEM OVERRIDE: Break down the task into a numbered, easy-to-follow Step-by-Step guide.\n\n----------------\n\n"]
                ]
            }
        };

        let lang = 'zh';
        let libraries = {};
        let currentDB = {};
        let rolesData = {};
        let inputValues = {};

        // Initialization
        async function init() {
            updateUIText();
            await loadMasterIndex();
        }

        function setLang(l) {
            lang = l;
            updateUIText();
            loadMasterIndex();
        }

        function updateUIText() {
            document.getElementById('lang-zh').classList.toggle('active', lang === 'zh');
            document.getElementById('lang-en').classList.toggle('active', lang === 'en');
            
            const t = UI_TEXT[lang];
            document.getElementById('guide-text').innerHTML = t.guide;
            document.getElementById('lbl-config').innerText = t.lbl_config;
            document.getElementById('lbl-vars').innerText = t.lbl_vars;
            document.getElementById('lbl-result').innerText = t.lbl_result;
            document.getElementById('lbl-lib').innerText = t.lbl_lib;
            document.getElementById('lbl-role').innerText = t.lbl_role;
            document.getElementById('lbl-task').innerText = t.lbl_task;
            document.getElementById('lbl-mode').innerText = t.lbl_output_mode;
            document.getElementById('btn-text').innerText = t.btn_copy;

            const modeSelect = document.getElementById('mode-select');
            modeSelect.innerHTML = t.mode_options.map(o => `<option value="${o[1]}">${o[0]}</option>`).join('');
        }

        async function loadMasterIndex() {
            const url = INDEX_URLS[lang];
            try {
                const r = await fetch(`${url}?t=${Date.now()}`);
                if (r.ok) {
                    libraries = await r.json();
                    document.getElementById('connection-status').innerText = UI_TEXT[lang].status_online;
                } else throw new Error();
            } catch (e) {
                libraries = FALLBACK_LIBRARIES;
                document.getElementById('connection-status').innerText = UI_TEXT[lang].status_offline;
            }

            const libSelect = document.getElementById('lib-select');
            libSelect.innerHTML = Object.keys(libraries).map(n => `<option value="${n}">${n}</option>`).join('');
            onLibChange();
        }

        async function onLibChange() {
            const libName = document.getElementById('lib-select').value;
            if (!libName || !libraries[libName]) return;
            
            try {
                const r = await fetch(`${libraries[libName]}?t=${Date.now()}`);
                if (r.ok) {
                    currentDB = await r.json();
                    rolesData = currentDB.roles || currentDB;
                    
                    const roleSelect = document.getElementById('role-select');
                    const roles = Object.keys(rolesData);
                    roleSelect.innerHTML = roles.map(r => `<option value="${r}">${r}</option>`).join('');
                    onRoleChange();
                }
            } catch (e) { console.error("Load lib failed", e); }
        }

        function onRoleChange() {
            const role = document.getElementById('role-select').value;
            if (!role || !rolesData[role]) return;
            const taskSelect = document.getElementById('task-select');
            const tasks = Object.keys(rolesData[role]);
            taskSelect.innerHTML = tasks.map(t => `<option value="${t}">${t}</option>`).join('');
            onTaskChange();
        }

        function onTaskChange() {
            const role = document.getElementById('role-select').value;
            const task = document.getElementById('task-select').value;
            if (!role || !task || !rolesData[role][task]) return;
            renderInputs(rolesData[role][task]);
        }

        function renderInputs(taskData) {
            const container = document.getElementById('vars-container');
            container.innerHTML = '';
            inputValues = {};

            if (taskData.description) {
                const desc = document.createElement('div');
                desc.className = 'description-box';
                desc.innerHTML = `<span>â„¹ï¸</span> <span>${taskData.description}</span>`;
                container.appendChild(desc);
            }

            for (const [k, v] of Object.entries(taskData.vars || {})) {
                const wrapper = document.createElement('div');
                if (k.endsWith('__multi') && Array.isArray(v)) {
                    const cleanK = k.replace('__multi', '');
                    wrapper.innerHTML = `<span class="section-label">${cleanK}</span>`;
                    const multiBox = document.createElement('div');
                    multiBox.className = 'multi-select';
                    inputValues[k] = [v[0]];
                    v.forEach(opt => {
                        const item = document.createElement('div');
                        item.className = 'item' + (inputValues[k].includes(opt) ? ' active' : '');
                        item.innerHTML = `<input type="checkbox" ${inputValues[k].includes(opt) ? 'checked' : ''}><span>${opt}</span>`;
                        item.onclick = () => {
                            const idx = inputValues[k].indexOf(opt);
                            if (idx > -1) { inputValues[k].splice(idx, 1); item.classList.remove('active'); item.querySelector('input').checked = false; }
                            else { inputValues[k].push(opt); item.classList.add('active'); item.querySelector('input').checked = true; }
                            updateResult();
                        };
                        multiBox.appendChild(item);
                    });
                    wrapper.appendChild(multiBox);
                } else if (Array.isArray(v)) {
                    wrapper.innerHTML = `<label class="section-label" style="margin-top:0; font-size:10px;">${k}</label>`;
                    const sel = document.createElement('select');
                    sel.innerHTML = v.map(o => `<option value="${o}">${o}</option>`).join('');
                    inputValues[k] = v[0];
                    sel.onchange = (e) => { inputValues[k] = e.target.value; updateResult(); };
                    wrapper.appendChild(sel);
                } else {
                    wrapper.innerHTML = `<label class="section-label" style="margin-top:0; font-size:10px;">${k}</label>`;
                    const inp = document.createElement('input');
                    inp.type = 'text'; inp.value = v; inputValues[k] = v;
                    inp.oninput = (e) => { inputValues[k] = e.target.value; updateResult(); };
                    wrapper.appendChild(inp);
                }
                container.appendChild(wrapper);
            }
            updateResult();
        }

        function updateResult() {
            const role = document.getElementById('role-select').value;
            const task = document.getElementById('task-select').value;
            if (!role || !task || !rolesData[role][task]) return;
            let tmpl = rolesData[role][task].template || '';
            const prefix = document.getElementById('mode-select').value;
            for (const [k, v] of Object.entries(inputValues)) {
                const val = Array.isArray(v) ? (v.length ? '\n- ' + v.join('\n- ') : '') : v;
                tmpl = tmpl.split(`{${k}}`).join(val);
            }
            document.getElementById('result-text').value = prefix + tmpl;
        }

        // --- æ ¸å¿ƒå¼·æ•ˆåŒæ­¥è¤‡è£½é‚è¼¯ ---
        function handleCopy() {
            const text = document.getElementById('result-text').value;
            const btn = document.getElementById('copy-btn');
            const btnText = document.getElementById('btn-text');
            const originalText = btnText.innerText;

            // 1. åŒæ­¥å»ºç«‹ TextArea (è¡Œå‹•ç«¯æœ€ç›¸å®¹)
            const textArea = document.createElement("textarea");
            textArea.value = text;
            // å¿…é ˆè®“å…ƒç´ ã€Œå¤§æ–¼ 1pxã€ä¸”ã€Œåœ¨è¢å¹•å…§ã€ä½†è¢«é®æ“‹ï¼Œè¡Œå‹•ç«¯æ‰ä¸æœƒæ‹’çµ•é¸å–
            textArea.style.position = "fixed";
            textArea.style.left = "0";
            textArea.style.top = "0";
            textArea.style.width = "200px";
            textArea.style.height = "200px";
            textArea.style.padding = "0";
            textArea.style.border = "none";
            textArea.style.outline = "none";
            textArea.style.boxShadow = "none";
            textArea.style.background = "transparent";
            textArea.style.color = "transparent";
            textArea.style.zIndex = "-9999";
            document.body.appendChild(textArea);
            
            textArea.focus();
            textArea.select();
            textArea.setSelectionRange(0, 99999);

            let success = false;
            try {
                success = document.execCommand('copy');
            } catch (err) { console.error("execCommand failed", err); }
            document.body.removeChild(textArea);

            // 2. å¦‚æœ execCommand å¤±æ•—ä¸”æœ‰ç¾ä»£ APIï¼Œå˜—è©¦ç¾ä»£ API
            if (!success && navigator.clipboard) {
                navigator.clipboard.writeText(text).then(() => {
                    showSuccess();
                }).catch(err => {
                    console.error("Clipboard API failed", err);
                    showManualFallback(text);
                });
                return;
            }

            if (success) showSuccess();
            else showManualFallback(text);

            function showSuccess() {
                btnText.innerText = UI_TEXT[lang].btn_copied;
                btn.style.background = "#059669";
                setTimeout(() => { btnText.innerText = originalText; btn.style.background = ""; }, 2000);
            }

            function showManualFallback(val) {
                // é€™æ˜¯æœ€å¾Œçš„é˜²ç·šï¼šå½ˆå‡ºå°è©±æ¡†è®“ä½¿ç”¨è€…æ‰‹å‹•è¤‡è£½
                const result = window.prompt("è‡ªå‹•è¤‡è£½å—é™ï¼Œè«‹è¤‡è£½ä¸‹æ–¹æŒ‡ä»¤ï¼š", val);
                if (result !== null) showSuccess();
            }
        }

        init();
    </script>
</body>
</html>
